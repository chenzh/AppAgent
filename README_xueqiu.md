# 雪球评论分析工具

这是一个用于抓取和分析雪球网评论数据的Python脚本，可以分析用户关注的热点话题、市场情绪和投资趋势。

## 功能特点

- 🔍 **数据抓取**: 自动抓取雪球网一周内的热门话题和评论
- 📊 **数据分析**: 提取关键词、分析市场情绪、统计行业关注度
- 🤖 **AI分析**: 使用阿里云通义千问API进行深度分析（可选）
- 📈 **报告生成**: 生成详细的分析报告和可视化摘要
- ⚙️ **配置灵活**: 支持自定义配置参数

## 文件说明

- `xueqiu_simple_analyzer.py` - 简化版分析脚本（推荐使用）
- `xueqiu_comment_analyzer.py` - 完整版分析脚本（需要AI API）
- `xueqiu_config.yaml` - 配置文件模板
- `requirements.txt` - 依赖包列表

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 基础使用（推荐）

```bash
# 分析最近7天的评论
python xueqiu_simple_analyzer.py

# 分析最近3天的评论
python xueqiu_simple_analyzer.py --days 3

# 指定输出文件
python xueqiu_simple_analyzer.py --output my_report.json

# 使用自定义配置文件
python xueqiu_simple_analyzer.py --config my_config.yaml
```

### 2. 高级使用（需要AI API）

1. 首先申请阿里云通义千问API密钥：
   - 访问 https://dashscope.console.aliyun.com/
   - 注册账号并申请API密钥

2. 配置API密钥：
   ```bash
   # 编辑配置文件
   vim xueqiu_config.yaml
   ```
   
   将 `api_key: "your_api_key_here"` 替换为你的实际API密钥

3. 运行分析：
   ```bash
   python xueqiu_comment_analyzer.py --days 7
   ```

## 配置说明

编辑 `xueqiu_config.yaml` 文件来自定义配置：

```yaml
# 阿里云通义千问API密钥（仅完整版需要）
api_key: "your_api_key_here"

# 数据抓取配置
max_comments: 1000      # 最大评论数量
timeout: 30             # 请求超时时间（秒）
retry_times: 3          # 重试次数

# 分析配置
analysis_days: 7        # 分析天数
max_topics: 10          # 最大话题数量
max_comments_per_topic: 50  # 每个话题最大评论数

# 输出配置
save_raw_data: true     # 是否保存原始数据
log_level: "INFO"       # 日志级别
```

## 输出结果

脚本会生成以下输出：

1. **控制台摘要**: 显示分析结果的关键信息
2. **JSON报告**: 包含完整分析数据的JSON文件
3. **日志文件**: 记录运行过程的日志

### 分析内容包括：

- 📈 **热门股票**: 按提及次数排序的股票代码
- 🏭 **行业关注度**: 各行业的讨论热度
- 😊 **市场情绪**: 乐观/悲观/中性的情绪分布
- 👥 **活跃用户**: 评论最多的用户统计
- 📝 **样本评论**: 代表性的评论内容

## 示例输出

```
============================================================
雪球评论分析报告（简化版）
============================================================
分析时间: 2024-01-15 14:30:25
分析周期: 最近7天
话题数量: 45
评论总数: 1234
有效评论: 1156

=== 雪球评论分析总结 ===

热门股票（按提及次数排序）：
  000001: 156次
  600036: 89次
  000858: 67次
  002415: 45次
  300059: 34次

行业关注度：
  科技: 234次提及
  新能源: 189次提及
  医药: 156次提及
  消费: 123次提及
  金融: 98次提及

市场情绪分布：
  乐观: 456条 (39.4%)
  中性: 389条 (33.6%)
  悲观: 311条 (26.9%)

总体统计：
  股票提及总数: 1234
  涉及行业数: 8

活跃用户:
  投资达人: 23条评论
  财经观察: 18条评论
  股市新手: 15条评论
  专业分析师: 12条评论
  散户小王: 10条评论
============================================================
```

## 注意事项

1. **请求频率**: 脚本内置了请求间隔，避免对服务器造成压力
2. **数据准确性**: 分析结果仅供参考，不构成投资建议
3. **API限制**: 使用AI分析功能时注意API调用次数限制
4. **网络环境**: 确保网络连接稳定，避免请求失败

## 故障排除

### 常见问题

1. **请求失败**: 检查网络连接和防火墙设置
2. **API错误**: 确认API密钥正确且有足够余额
3. **数据为空**: 可能是雪球网API变更，需要更新脚本
4. **编码错误**: 确保系统支持UTF-8编码

### 日志查看

```bash
# 查看运行日志
tail -f xueqiu_simple_analyzer.log
```

## 开发说明

### 项目结构

```
├── xueqiu_simple_analyzer.py    # 简化版分析器
├── xueqiu_comment_analyzer.py   # 完整版分析器
├── xueqiu_config.yaml          # 配置文件
├── requirements.txt             # 依赖列表
└── README_xueqiu.md           # 使用说明
```

### 扩展功能

可以基于现有代码扩展以下功能：

- 📊 数据可视化（图表生成）
- 🔄 定时任务（自动分析）
- 📧 邮件通知（结果推送）
- 🗄️ 数据库存储（历史数据）
- 🌐 Web界面（在线分析）

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

---

**免责声明**: 本工具仅用于学习和研究目的，分析结果不构成投资建议。使用本工具进行投资决策的风险由用户自行承担。